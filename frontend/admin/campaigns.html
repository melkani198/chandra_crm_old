<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Campaigns - Chandra CRM</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
body {
    margin:0;
    font-family:Inter,sans-serif;
    background:linear-gradient(135deg,#0f172a,#1e1b4b,#0f172a);
    color:#fff;
}
.layout { display:flex; min-height:100vh; }
.sidebar { width:260px; background:#0f172a; padding:20px; }
.main { flex:1; padding:30px; }
.card {
    background:rgba(255,255,255,0.05);
    border-radius:15px;
    padding:20px;
}
input, select {
    width:100%;
    padding:10px;
    border-radius:8px;
    border:none;
    margin-bottom:10px;
}
button {
    padding:10px 15px;
    border:none;
    border-radius:8px;
    cursor:pointer;
}
.btn-primary { background:#06b6d4; color:white; }
.table {
    width:100%;
    border-collapse:collapse;
}
.table th, .table td {
    padding:12px;
    border-bottom:1px solid rgba(255,255,255,0.1);
}
</style>
</head>

<body>

<div class="layout">

<div class="sidebar">
    <h2>Chandra CRM</h2>
    <a href="admin-dashboard.html">Dashboard</a><br><br>
    <a href="campaigns.html">Campaigns</a><br><br>
</div>

<div class="main">

<h1>Campaign Management</h1>

<div class="card">
    <h3>Create Campaign</h3>

    <input type="text" id="name" placeholder="Campaign Name">
    <select id="type">
        <option value="progressive">Progressive</option>
        <option value="predictive">Predictive</option>
        <option value="ivrblast">IVR Blast</option>
        <option value="manual">Manual</option>
    </select>

    <input type="text" id="caller_id" placeholder="Caller ID">
    <input type="number" id="wrap_up_time" placeholder="Wrap Up Time (sec)">
    
    <button class="btn-primary" onclick="createCampaign()">Create</button>
</div>

<br>

<div class="card">
    <h3>All Campaigns</h3>
    <table class="table" id="campaignTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Status</th>
                <th>Total Contacts</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

</div>
</div>

<script>

const API = "/chandra_crm/php-backend";

function getToken() {
    return localStorage.getItem("token");
}

async function apiCall(endpoint, method="GET", body=null) {
    const options = {
        method,
        headers:{
            "Content-Type":"application/json",
            "Authorization":"Bearer "+getToken()
        }
    };
    if(body) options.body = JSON.stringify(body);

    const res = await fetch(API+endpoint, options);
    return res.json();
}

async function loadCampaigns() {
    const data = await apiCall("/campaigns");
    const tbody = document.querySelector("#campaignTable tbody");
    tbody.innerHTML="";

    data.forEach(c=>{
        tbody.innerHTML += `
            <tr>
                <td>${c.name}</td>
                <td>${c.campaign_type}</td>
                <td>${c.status}</td>
                <td>${c.total_contacts}</td>
            </tr>
        `;
    });
}

async function createCampaign() {
    await apiCall("/campaigns","POST",{
        name:document.getElementById("name").value,
        campaign_type:document.getElementById("type").value,
        caller_id:document.getElementById("caller_id").value,
        wrap_up_time:document.getElementById("wrap_up_time").value
    });
    loadCampaigns();
}

window.onload = loadCampaigns;

</script>

</body>
</html>

